<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TAT: include/TAT/tensor.hpp 源文件</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TAT
   &#160;<span id="projectnumber">0.1.4</span>
   </div>
   <div id="projectbrief">TAT is A Tensor library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('tensor_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">tensor.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="tensor_8hpp.html">浏览该文件的文档.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#ifndef TAT_TENSOR_HPP</span></div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="tensor_8hpp.html#aad98d87f1a7f9d311598c6ee13a21347">   22</a></span>&#160;<span class="preprocessor">#define TAT_TENSOR_HPP</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="basic__type_8hpp.html">basic_type.hpp</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="core_8hpp.html">core.hpp</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="edge_8hpp.html">edge.hpp</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="name_8hpp.html">name.hpp</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pmr__resource_8hpp.html">pmr_resource.hpp</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="propagate__const_8hpp.html">propagate_const.hpp</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="symmetry_8hpp.html">symmetry.hpp</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceTAT.html">TAT</a> {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ScalarType = <span class="keywordtype">double</span>, <span class="keyword">typename</span> Symmetry = NoSymmetry, <span class="keyword">typename</span> Name = DefaultName&gt;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html">   51</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="structTAT_1_1Singular.html">Singular</a> {</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#a2709db65768862bc9c5d05fa6686cb9a">   52</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Singular.html#a2709db65768862bc9c5d05fa6686cb9a">normal_map</a> = std::map&lt;Symmetry, vector&lt;real_base_t&lt;ScalarType&gt;&gt;&gt;;</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#a251207a171aed3995dda904fec5528f6">   53</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1fake__map.html">fake_singular_map</a> = <a class="code" href="structTAT_1_1fake__map.html">fake_map&lt;Symmetry, vector&lt;real_base_t&lt;ScalarType&gt;</a>&gt;&gt;;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#ifdef TAT_USE_SIMPLE_NOSYMMETRY</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Singular.html#aeed42467b017f72ad76cdfea159622d3">singular_map</a> = std::conditional_t&lt;std::is_same_v&lt;Symmetry, NoSymmetry&gt;, <a class="code" href="structTAT_1_1Singular.html#a251207a171aed3995dda904fec5528f6">fake_singular_map</a>, <a class="code" href="structTAT_1_1Singular.html#a2709db65768862bc9c5d05fa6686cb9a">normal_map</a>&gt;;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#aeed42467b017f72ad76cdfea159622d3">   57</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Singular.html#aeed42467b017f72ad76cdfea159622d3">singular_map</a> = <a class="code" href="structTAT_1_1Singular.html#a2709db65768862bc9c5d05fa6686cb9a">normal_map</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#a631e4cbdf89566dcb8dd525f9648bc65">   59</a></span>&#160;      <a class="code" href="structTAT_1_1Singular.html#aeed42467b017f72ad76cdfea159622d3">singular_map</a> <a class="code" href="structTAT_1_1Singular.html#a631e4cbdf89566dcb8dd525f9648bc65">value</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> p&gt;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#a17de08d8837e04b110ae0d6ea2a90676">   62</a></span>&#160;      [[nodiscard]] <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a> <a class="code" href="structTAT_1_1Singular.html#a17de08d8837e04b110ae0d6ea2a90676">norm</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         <span class="keywordflow">if</span> constexpr (p == -1) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a> maximum = 0;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [symmetry, singulars] : <a class="code" href="structTAT_1_1Singular.html#a631e4cbdf89566dcb8dd525f9648bc65">value</a>) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;               <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; element : singulars) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                  <span class="keyword">auto</span> absolute = std::abs(element);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                  maximum = maximum &lt; absolute ? absolute : maximum;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;               }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">return</span> maximum;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (p == 1) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a> summation = 0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [symmetry, singulars] : <a class="code" href="structTAT_1_1Singular.html#a631e4cbdf89566dcb8dd525f9648bc65">value</a>) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;               <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; element : singulars) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                  <span class="keyword">auto</span> absolute = std::abs(element);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                  summation += absolute;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;               }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="keywordflow">return</span> summation;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <a class="code" href="group__Miscellaneous.html#ga40f46f83982bd27a7e204d8a1360b6a0">TAT_error</a>(<span class="stringliteral">&quot;Not Implement For Singulars Normalize Kind, Only +1 and -1 supported now&quot;</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;         }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      [[nodiscard]] std::string <a class="code" href="group__IO.html#gaa69be631b50d82c02164fe90977565b0">show</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      [[nodiscard]] std::string <a class="code" href="group__IO.html#ga020c0be4a859687755aeef9b910d5c1b">dump</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="structTAT_1_1Singular.html">Singular&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Singular.html#a1acbadd2866fc14ef81b549cd25b2686">load</a>(<span class="keyword">const</span> std::string&amp;) &amp;;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#a92fcbf9f6877a19832fa15b38af050e4">   90</a></span>&#160;      <a class="code" href="structTAT_1_1Singular.html">Singular&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Singular.html#a92fcbf9f6877a19832fa15b38af050e4">load</a>(<span class="keyword">const</span> std::string&amp; <span class="keywordtype">string</span>) &amp;&amp; {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Singular.html#a1acbadd2866fc14ef81b549cd25b2686">load</a>(<span class="keywordtype">string</span>));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      };</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#a9a4807a3020bf392da21d2b744bb7aa7">   94</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Singular.html">Singular&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Singular.html#a9a4807a3020bf392da21d2b744bb7aa7">copy</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Singular.html">Singular&lt;ScalarType, Symmetry, Name&gt;</a>{<a class="code" href="structTAT_1_1Singular.html#a631e4cbdf89566dcb8dd525f9648bc65">value</a>};</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   };</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ScalarType, <span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Name&gt;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <span class="keyword">struct </span>TensorShape;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ScalarType = <span class="keywordtype">double</span>, <span class="keyword">typename</span> Symmetry = NoSymmetry, <span class="keyword">typename</span> Name = DefaultName&gt;</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html">  122</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="structTAT_1_1Tensor.html">Tensor</a> {</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a9cc15c9afe143966029c1d0dc8fa6f91">  123</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#a9cc15c9afe143966029c1d0dc8fa6f91">scalar_valid</a> = std::enable_if_t&lt;is_scalar_v&lt;ScalarType&gt;&gt;;</div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a04b37643797ad7da56f258c2996a4135">  124</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#a04b37643797ad7da56f258c2996a4135">symmetry_valid</a> = std::enable_if_t&lt;is_symmetry_v&lt;Symmetry&gt;&gt;;</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a529084aace9257dd27b0b61bde589888">  125</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#a529084aace9257dd27b0b61bde589888">name_valid</a> = std::enable_if_t&lt;is_name_v&lt;Name&gt;&gt;;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="comment">// TODO: private访问控制</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a15ae4dc3b9a92e28e5caa19348aa6611">  128</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#a15ae4dc3b9a92e28e5caa19348aa6611">scalar_t</a> = ScalarType;</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a7291a74010a6cd0637cbbb18f49e5c0a">  129</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1NoSymmetry.html">symmetry_t</a> = Symmetry;</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ab253208ffbb59d448642e70912247293">  130</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1FastName.html">name_t</a> = <a class="code" href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">Name</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a8b911cc9fe3e3ad898eeaeceeeb8f9de">  131</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Edge.html">edge_t</a> = <a class="code" href="structTAT_1_1Edge.html">Edge&lt;Symmetry&gt;</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">  137</a></span>&#160;      std::vector&lt;Name&gt; <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">  142</a></span>&#160;      std::map&lt;Name, Rank&gt; <a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">  148</a></span>&#160;      <a class="code" href="structTAT_1_1propagate__const__shared__ptr.html">propagate_const_shared_ptr&lt;Core&lt;ScalarType, Symmetry&gt;</a>&gt; <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#aff05894668cca4af943c6dfa4eecaa59">  150</a></span>&#160;      TensorShape&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#aff05894668cca4af943c6dfa4eecaa59">shape</a>() {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;         <span class="keywordflow">return</span> {<span class="keyword">this</span>};</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> VectorName = pmr::vector&lt;Name&gt;, <span class="keyword">typename</span> VectorEdge = pmr::vector&lt;Edge&lt;Symmetry&gt;&gt;&gt;</div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a75826991f1d896a066b3bad29dd3e135">  162</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a75826991f1d896a066b3bad29dd3e135">Tensor</a>(<span class="keyword">const</span> VectorName&amp; names_init, <span class="keyword">const</span> VectorEdge&amp; edges_init, <span class="keyword">const</span> <span class="keywordtype">bool</span> auto_reverse = <span class="keyword">false</span>) :</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>(names_init.begin(), names_init.end()),</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a>(construct_name_to_index&lt;decltype(<a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a>)&gt;(<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>)),</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>(std::make_shared&lt;<a class="code" href="structTAT_1_1Core.html">Core</a>&lt;ScalarType, Symmetry&gt;&gt;(edges_init, auto_reverse)) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;         check_valid_name(<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>, <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;edges.size());</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a9d94cc5a258afdf3b256779df8a8bd9b">  174</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a9d94cc5a258afdf3b256779df8a8bd9b">copy</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;         <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> result;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;         result.<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a> = <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;         result.<a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a> = <a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;         result.<a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a> = std::make_shared&lt;Core&lt;ScalarType, Symmetry&gt;&gt;(*core);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;         <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a67773ad17527d10e1129478340cda72e">  182</a></span>&#160;      [[nodiscard]] <span class="keywordtype">bool</span> <a class="code" href="structTAT_1_1Tensor.html#a67773ad17527d10e1129478340cda72e">is_valid</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;         <span class="keywordflow">return</span> bool(<a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#ifdef TAT_USE_VALID_DEFAULT_TENSOR</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>() : <a class="code" href="structTAT_1_1Tensor.html">Tensor</a>(1){};</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>(<span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp; other) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>(<a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp;&amp; other) noexcept = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#a2e1ca6a58056b952a50e3238ba2a533c">operator=</a>(<span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp; other) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#a2e1ca6a58056b952a50e3238ba2a533c">operator=</a>(<a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp;&amp; other) noexcept = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a1d423525b08fa4b1624435798c2be80d">~Tensor</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a4804ab139acbaa19d5efb0b033653e71">  201</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a4804ab139acbaa19d5efb0b033653e71">Tensor</a>(ScalarType number) : <a class="code" href="structTAT_1_1Tensor.html">Tensor</a>({}, {}) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;         <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;blocks.begin()-&gt;second.front() = number;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> VectorName = pmr::vector&lt;Name&gt;, <span class="keyword">typename</span> VectorSymmetry = pmr::vector&lt;Symmetry&gt;, <span class="keyword">typename</span> VectorArrow = pmr::vector&lt;Arrow&gt;&gt;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      [[nodiscard]] <span class="keyword">static</span> Tensor&lt;ScalarType, Symmetry, Name&gt;</div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ae76f569d5a096ccc07f2977a96d5d7b6">  214</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ae76f569d5a096ccc07f2977a96d5d7b6">one</a>(ScalarType number, <span class="keyword">const</span> VectorName&amp; names_init, <span class="keyword">const</span> VectorSymmetry&amp; edge_symmetry = {}, <span class="keyword">const</span> VectorArrow&amp; edge_arrow = {}) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;         <span class="keyword">auto</span> rank = names_init.size();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;         <span class="keyword">auto</span> result = <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>(names_init, get_edge_from_edge_symmetry_and_arrow(edge_symmetry, edge_arrow, rank));</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;         result.core-&gt;blocks.begin()-&gt;second.front() = number;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;         <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a2a45b860499d4eaa7829efd3bcbdb1e9">  221</a></span>&#160;      [[nodiscard]] <span class="keywordtype">bool</span> <a class="code" href="structTAT_1_1Tensor.html#a2a45b860499d4eaa7829efd3bcbdb1e9">is_scalar</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;blocks.size() == 1 &amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;blocks.begin()-&gt;second.size() == 1;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ab836bd75946c187a1cc2acbaf1921cb6">  228</a></span>&#160;      <span class="keyword">operator</span> ScalarType()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="structTAT_1_1Tensor.html#a2a45b860499d4eaa7829efd3bcbdb1e9">is_scalar</a>()) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <a class="code" href="group__Miscellaneous.html#ga40f46f83982bd27a7e204d8a1360b6a0">TAT_error</a>(<span class="stringliteral">&quot;Try to get the only element of the tensor which contains more than one element&quot;</span>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;         }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;blocks.begin()-&gt;second.front();</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#abb9bf6205f203393f073d0b536778c2b">  235</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#abb9bf6205f203393f073d0b536778c2b">EdgePoint</a> = std::conditional_t&lt;std::is_same_v&lt;Symmetry, NoSymmetry&gt;, <a class="code" href="group__Miscellaneous.html#ga165aa7ea040b184dc85762582d2b5a9c">Size</a>, std::tuple&lt;Symmetry, Size&gt;&gt;;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#aff45c9ef8b017796d20055023e732a28">EdgePointWithArrow</a> = std::conditional_t&lt;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            std::is_same_v&lt;Symmetry, NoSymmetry&gt;,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            std::tuple&lt;Size, Size&gt;,</div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#aff45c9ef8b017796d20055023e732a28">  239</a></span>&#160;            std::conditional_t&lt;is_fermi_symmetry_v&lt;Symmetry&gt;, std::tuple&lt;Arrow, Symmetry, Size, Size&gt;, std::tuple&lt;Symmetry, Size, Size&gt;&gt;&gt;;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ExpandConfigure = pmr::map&lt;Name, EdgePo<span class="keywordtype">int</span>WithArrow&gt;&gt;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ab2704312b6957e2fa2c1f4636449032c">expand</a>(<span class="keyword">const</span> ExpandConfigure&amp; configure, <span class="keyword">const</span> <a class="code" href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">Name</a>&amp; old_name = <a class="code" href="structTAT_1_1InternalName.html">InternalName&lt;Name&gt;::No_Old_Name</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ShrinkConfigure = pmr::map&lt;Name, EdgePo<span class="keywordtype">int</span>&gt;&gt;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#aae145191f04bc2ce554e695b748d260c">shrink</a>(<span class="keyword">const</span> ShrinkConfigure&amp; configure, <span class="keyword">const</span> <a class="code" href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">Name</a>&amp; new_name = <a class="code" href="structTAT_1_1InternalName.html">InternalName&lt;Name&gt;::No_New_Name</a>, <a class="code" href="group__Miscellaneous.html#ga78326bee7cc963cd2d165718de5c0465">Arrow</a> arrow = <span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Use shrink instead, slice will be remove in v0.2.0&quot;</span>)]] [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a></div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#af8cbdc992c718c5eba66e7f775969d83">  250</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#af8cbdc992c718c5eba66e7f775969d83">slice</a>(<span class="keyword">const</span> <a class="code" href="namespaceTAT_1_1pmr.html#ac746848942f6f83b133482f63b1fd320">pmr::map&lt;Name, EdgePoint&gt;</a>&amp; configure, <span class="keyword">const</span> <a class="code" href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">Name</a>&amp; new_name = <a class="code" href="structTAT_1_1InternalName.html">InternalName&lt;Name&gt;::No_New_Name</a>, <a class="code" href="group__Miscellaneous.html#ga78326bee7cc963cd2d165718de5c0465">Arrow</a> arrow = <span class="keyword">false</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#aae145191f04bc2ce554e695b748d260c">shrink</a>(configure, new_name, arrow);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a8419fd382c3d74ceafb7b9b06e0214ca">  258</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a8419fd382c3d74ceafb7b9b06e0214ca">same_shape</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>(<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>, <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;edges);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Function&gt;</div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a696aaccadd2f6ff256bdaa24ffe4f9e2">  269</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a696aaccadd2f6ff256bdaa24ffe4f9e2">map</a>(Function&amp;&amp; <span class="keyword">function</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;         <span class="keyword">auto</span> result = <a class="code" href="structTAT_1_1Tensor.html#a8419fd382c3d74ceafb7b9b06e0214ca">same_shape</a>();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [symmetries, <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            std::transform(<a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>.begin(), <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>.end(), result.core-&gt;blocks.at(symmetries).begin(), <span class="keyword">function</span>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;         }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;         <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Function&gt;</div>
<div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ae873994e0ed16334f85febd570ab4117">  285</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#ae873994e0ed16334f85febd570ab4117">transform</a>(Function&amp;&amp; <span class="keyword">function</span>) &amp; {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>.use_count() != 1) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a> = std::make_shared&lt;Core&lt;ScalarType, Symmetry&gt;&gt;(*core);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            TAT_warning_or_error_when_copy_shared(<span class="stringliteral">&quot;Set tensor shared, copy happened here&quot;</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;         }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [_, <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            std::transform(<a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>.begin(), <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>.end(), <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>.begin(), <span class="keyword">function</span>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;         }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;         <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Function&gt;</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a2a95bf05974e36d8109a1b0ec695edac">  296</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#a2a95bf05974e36d8109a1b0ec695edac">transform</a>(Function&amp;&amp; <span class="keyword">function</span>) &amp;&amp; {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Tensor.html#ae873994e0ed16334f85febd570ab4117">transform</a>(<span class="keyword">function</span>));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Generator&gt;</div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">  307</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">set</a>(Generator&amp;&amp; generator) &amp; {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         <a class="code" href="structTAT_1_1Tensor.html#ae873994e0ed16334f85febd570ab4117">transform</a>([&amp;](ScalarType _) { <span class="keywordflow">return</span> generator(); });</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;         <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Generator&gt;</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a2c908557416bb3b3c72896320aa30106">  312</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#a2c908557416bb3b3c72896320aa30106">set</a>(Generator&amp;&amp; generator) &amp;&amp; {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">set</a>(generator));</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a25052984c028c2913d77fc0ed079f02d">  321</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#a25052984c028c2913d77fc0ed079f02d">zero</a>() &amp; {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">set</a>([]() { <span class="keywordflow">return</span> 0; });</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      }</div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ae63a2323a01a71dda38b8856cb5a532b">  324</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#ae63a2323a01a71dda38b8856cb5a532b">zero</a>() &amp;&amp; {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Tensor.html#a25052984c028c2913d77fc0ed079f02d">zero</a>());</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a070c446e688bad4dd586b4e5f23ebb6c">  333</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#a070c446e688bad4dd586b4e5f23ebb6c">test</a>(ScalarType first = 0, ScalarType step = 1) &amp; {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">set</a>([&amp;first, step]() {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keyword">auto</span> result = first;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            first += step;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;         });</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      }</div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a0fe4f7437b71de7367ca2623a2111aaa">  340</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#a0fe4f7437b71de7367ca2623a2111aaa">test</a>(ScalarType first = 0, ScalarType step = 1) &amp;&amp; {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Tensor.html#a070c446e688bad4dd586b4e5f23ebb6c">test</a>(first, step));</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MapNameSymmetry = pmr::map&lt;Name, Symmetry&gt;&gt;</div>
<div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">  351</a></span>&#160;      [[nodiscard]] <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>(<span class="keyword">const</span> MapNameSymmetry&amp; position = {}) <span class="keyword">const</span>&amp; {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#a61ddce75b3513e9d6ac7f494ae0bc04d">const_block</a>(position);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MapNameSymmetry = pmr::map&lt;Name, Symmetry&gt;&gt;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      [[nodiscard]] <span class="keyword">auto</span>&amp; <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>(<span class="keyword">const</span> MapNameSymmetry&amp; position = {}) &amp;;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MapNameSymmetry = pmr::map&lt;Name, Symmetry&gt;&gt;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      [[nodiscard]] <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="structTAT_1_1Tensor.html#a61ddce75b3513e9d6ac7f494ae0bc04d">const_block</a>(<span class="keyword">const</span> MapNameSymmetry&amp; position = {}) <span class="keyword">const</span>&amp;;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MapNameEdgePo<span class="keywordtype">int</span> = pmr::map&lt;Name, EdgePo<span class="keywordtype">int</span>&gt;&gt;</div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#aeffed0720af6620f8dbb60be83cdcfc5">  367</a></span>&#160;      [[nodiscard]] <span class="keyword">const</span> ScalarType&amp; <a class="code" href="structTAT_1_1Tensor.html#aeffed0720af6620f8dbb60be83cdcfc5">at</a>(<span class="keyword">const</span> MapNameEdgePoint&amp; position) <span class="keyword">const</span>&amp; {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ae834de3ebb8d1ad7324561831bab33f0">const_at</a>(position);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MapNameEdgePo<span class="keywordtype">int</span> = pmr::map&lt;Name, EdgePo<span class="keywordtype">int</span>&gt;&gt;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      [[nodiscard]] ScalarType&amp; <a class="code" href="structTAT_1_1Tensor.html#aeffed0720af6620f8dbb60be83cdcfc5">at</a>(<span class="keyword">const</span> MapNameEdgePoint&amp; position) &amp;;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MapNameEdgePo<span class="keywordtype">int</span> = pmr::map&lt;Name, EdgePo<span class="keywordtype">int</span>&gt;&gt;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      [[nodiscard]] <span class="keyword">const</span> ScalarType&amp; <a class="code" href="structTAT_1_1Tensor.html#ae834de3ebb8d1ad7324561831bab33f0">const_at</a>(<span class="keyword">const</span> MapNameEdgePoint&amp; position) <span class="keyword">const</span>&amp;;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> OtherScalarType, <span class="keyword">typename</span> = std::enable_if_t&lt;is_scalar_v&lt;OtherScalarType&gt;&gt;&gt;</div>
<div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ab102bd3898b58fff24b10ed07f3221e6">  383</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;OtherScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#ab102bd3898b58fff24b10ed07f3221e6">to</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;         <span class="keywordflow">if</span> constexpr (std::is_same_v&lt;ScalarType, OtherScalarType&gt;) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="keyword">auto</span> result = <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>{};</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            result.<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a> = <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            result.name_to_index = <a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            result.core = <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="keyword">auto</span> result = <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;OtherScalarType, Symmetry, Name&gt;</a>{};</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            result.<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a> = <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            result.name_to_index = <a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            result.core = std::make_shared&lt;Core&lt;OtherScalarType, Symmetry&gt;&gt;();</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            result.core-&gt;edges = <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;edges;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [symmetries, <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;               <span class="keyword">auto</span> [iterator, success] = result.core-&gt;blocks.emplace(symmetries, <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>.size());</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;               <span class="keyword">auto</span>&amp; this_block = iterator-&gt;second;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;               <span class="keywordflow">for</span> (<a class="code" href="group__Miscellaneous.html#ga165aa7ea040b184dc85762582d2b5a9c">Size</a> i = 0; i &lt; <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>.size(); i++) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                  <span class="keywordflow">if</span> constexpr (is_complex_v&lt;ScalarType&gt; &amp;&amp; is_real_v&lt;OtherScalarType&gt;) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                     this_block[i] = OtherScalarType(<a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>[i].<a class="code" href="namespacesquare.html#a38e8aadaa8b92f8927c15bef40111b7a">real</a>());</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                     this_block[i] = OtherScalarType(<a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>[i]);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                  }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;               }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;         }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> p = 2&gt;</div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a6cb81dfbd5808d32766b0acf5a60a9aa">  417</a></span>&#160;      [[nodiscard]] <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a6cb81dfbd5808d32766b0acf5a60a9aa">norm</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;         <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a> result = 0;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;         <span class="keywordflow">if</span> constexpr (p == -1) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [_, <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;               <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; number : <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                  <span class="keywordflow">if</span> (<span class="keyword">auto</span> absolute_value = std::abs(number); absolute_value &gt; result) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                     result = absolute_value;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                  }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;               }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (p == 0) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [_, <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;               result += <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a>(<a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>.size());</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [_, <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;               <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; number : <a class="code" href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">block</a>) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                  <span class="keywordflow">if</span> constexpr (p == 1) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                     result += std::abs(number);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (p == 2) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                     result += std::norm(number);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                     <span class="keywordflow">if</span> constexpr (p % 2 == 0 &amp;&amp; is_real_v&lt;ScalarType&gt;) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        result += std::pow(number, p);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                     } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                        result += std::pow(std::abs(number), p);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                     }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                  }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;               }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            result = std::pow(result, 1. / p);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;         }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;         <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keyword">template</span>&lt;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keyword">typename</span> MapNameName = <a class="code" href="namespaceTAT_1_1pmr.html#ac746848942f6f83b133482f63b1fd320">pmr::map&lt;Name, Name&gt;</a>,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keyword">typename</span> MapNameVectorNameAndEdge = <a class="code" href="namespaceTAT_1_1pmr.html#ac746848942f6f83b133482f63b1fd320">pmr::map&lt;Name, std::vector&lt;std::tuple&lt;Name, BoseEdge&lt;Symmetry&gt;</a>&gt;&gt;&gt;,</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="keyword">typename</span> SetName1 = <a class="code" href="namespaceTAT_1_1pmr.html#a585ff764333557a89bfa554774c2d16c">pmr::set&lt;Name&gt;</a>,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="keyword">typename</span> MapNameVectorName = <a class="code" href="namespaceTAT_1_1pmr.html#ac746848942f6f83b133482f63b1fd320">pmr::map&lt;Name, std::vector&lt;Name&gt;</a>&gt;,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keyword">typename</span> VectorName = <a class="code" href="namespaceTAT_1_1pmr.html#a9a7e8d6310c5e03b7f1d016a4f5389d0">pmr::vector&lt;Name&gt;</a>,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keyword">typename</span> SetName2 = <a class="code" href="namespaceTAT_1_1pmr.html#a585ff764333557a89bfa554774c2d16c">pmr::set&lt;Name&gt;</a>,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keyword">typename</span> MapNameMapSymmetrySize = <a class="code" href="namespaceTAT_1_1pmr.html#ac746848942f6f83b133482f63b1fd320">pmr::map&lt;Name, std::map&lt;Symmetry, Size&gt;</a>&gt;&gt;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a03674ac4734f948d48574ba39b2f6103">edge_operator</a>(</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="keyword">const</span> MapNameName&amp; rename_map,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keyword">const</span> MapNameVectorNameAndEdge&amp; split_map,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keyword">const</span> SetName1&amp; reversed_name,</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="keyword">const</span> MapNameVectorName&amp; merge_map,</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keyword">const</span> VectorName&amp; new_names,</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordtype">bool</span> apply_parity = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keyword">const</span> std::array&lt;SetName2, 4&gt;&amp; parity_exclude_name = {{{}, {}, {}, {}}},</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="keyword">const</span> MapNameMapSymmetrySize&amp; edge_and_symmetries_to_cut_before_all = {}) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MapNameName = pmr::map&lt;Name, Name&gt;&gt;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      [[nodiscard]] <span class="keyword">auto</span> <a class="code" href="structTAT_1_1Tensor.html#a444f0f89149df8858c2583ab833aa2f4">edge_rename</a>(<span class="keyword">const</span> MapNameName&amp; dictionary) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> VectorName = pmr::vector&lt;Name&gt;&gt;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#a2836a28ed1deb986d2033b7e63f805dd">transpose</a>(<span class="keyword">const</span> VectorName&amp; target_names) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> SetName1 = pmr::set&lt;Name&gt;, <span class="keyword">typename</span> SetName2 = pmr::set&lt;Name&gt;&gt;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a67380e7a331cc50e526dc93cf7047531">reverse_edge</a>(<span class="keyword">const</span> SetName1&amp; reversed_name, <span class="keywordtype">bool</span> apply_parity = <span class="keyword">false</span>, SetName2&amp;&amp; parity_exclude_name = {}) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MapNameVectorName = pmr::map&lt;Name, std::vector&lt;Name&gt;&gt;, <span class="keyword">typename</span> SetName = pmr::set&lt;Name&gt;&gt;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#ab340c1d28f5e68c87fd000ea4f77a2e5">merge_edge</a>(</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            MapNameVectorName merge,</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordtype">bool</span> apply_parity = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            SetName&amp;&amp; parity_exclude_name_merge = {},</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            SetName&amp;&amp; parity_exclude_name_reverse = {}) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keyword">template</span>&lt;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keyword">typename</span> MapNameVectorNameAndEdge = pmr::map&lt;Name, std::vector&lt;std::tuple&lt;Name, BoseEdge&lt;Symmetry&gt;&gt;&gt;&gt;,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="keyword">typename</span> SetName = pmr::set&lt;Name&gt;&gt;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ac8040216c9eacaa2f5c61a6768bc0af3">split_edge</a>(MapNameVectorNameAndEdge split, <span class="keywordtype">bool</span> apply_parity = <span class="keyword">false</span>, SetName&amp;&amp; parity_exclude_name_split = {}) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="comment">// 可以考虑不转置成矩阵直接乘积的可能, 但这个最多优化N^2的常数次, 只需要转置不调用多次就不会产生太大的问题</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"></span>      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> SetNameAndName = pmr::set&lt;std::tuple&lt;Name, Name&gt;&gt;&gt;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      [[nodiscard]] <span class="keyword">static</span> Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#ab926afb993eff5213b7d8ebc01fe8b2b">contract</a>(</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            <span class="keyword">const</span> Tensor&lt;ScalarType, Symmetry, Name&gt;&amp; tensor_1,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keyword">const</span> Tensor&lt;ScalarType, Symmetry, Name&gt;&amp; tensor_2,</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            SetNameAndName&amp;&amp; contract_names);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ScalarType1, <span class="keyword">typename</span> ScalarType2, <span class="keyword">typename</span> SetNameAndName = pmr::set&lt;std::tuple&lt;Name, Name&gt;&gt;&gt;</div>
<div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a970d6dea974e504dad24237d31f5e998">  557</a></span>&#160;      [[nodiscard]] <span class="keyword">static</span> <span class="keyword">auto</span> <a class="code" href="structTAT_1_1Tensor.html#a970d6dea974e504dad24237d31f5e998">contract</a>(</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType1, Symmetry, Name&gt;</a>&amp; tensor_1,</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType2, Symmetry, Name&gt;</a>&amp; tensor_2,</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            SetNameAndName&amp;&amp; contract_names) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;         <span class="keyword">using</span> ResultScalarType = std::common_type_t&lt;ScalarType1, ScalarType2&gt;;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;         <span class="keyword">using</span> ResultTensor = <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ResultScalarType, Symmetry, Name&gt;</a>;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;         <span class="keywordflow">if</span> constexpr (std::is_same_v&lt;ResultScalarType, ScalarType1&gt;) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <span class="keywordflow">if</span> constexpr (std::is_same_v&lt;ResultScalarType, ScalarType2&gt;) {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;               <span class="keywordflow">return</span> ResultTensor::contract(tensor_1, tensor_2, std::forward&lt;SetNameAndName&gt;(contract_names));</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;               <span class="keywordflow">return</span> ResultTensor::contract(tensor_1, tensor_2.template to&lt;ResultScalarType&gt;(), std::forward&lt;SetNameAndName&gt;(contract_names));</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordflow">if</span> constexpr (std::is_same_v&lt;ResultScalarType, ScalarType2&gt;) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;               <span class="keywordflow">return</span> ResultTensor::contract(tensor_1.template to&lt;ResultScalarType&gt;(), tensor_2, std::forward&lt;SetNameAndName&gt;(contract_names));</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;               <span class="keywordflow">return</span> ResultTensor::contract(</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                     tensor_1.template to&lt;ResultScalarType&gt;(),</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                     tensor_2.template to&lt;ResultScalarType&gt;(),</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                     std::forward&lt;SetNameAndName&gt;(contract_names));</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;         }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> OtherScalarType, <span class="keyword">typename</span> SetNameAndName = pmr::set&lt;std::tuple&lt;Name, Name&gt;&gt;&gt;</div>
<div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a5f9629c5b510af787335c696b98198bb">  582</a></span>&#160;      [[nodiscard]] <span class="keyword">auto</span> <a class="code" href="structTAT_1_1Tensor.html#a5f9629c5b510af787335c696b98198bb">contract</a>(<span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;OtherScalarType, Symmetry, Name&gt;</a>&amp; tensor_2, SetNameAndName&amp;&amp; contract_names)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ab926afb993eff5213b7d8ebc01fe8b2b">contract</a>(*<span class="keyword">this</span>, tensor_2, std::forward&lt;SetNameAndName&gt;(contract_names));</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a99633cbb2776da691ad804a23f8e7d99">  591</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a99633cbb2776da691ad804a23f8e7d99">contract_all_edge</a>(<span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;         <span class="keyword">auto</span> pmr_guard = <a class="code" href="structTAT_1_1scope__resource.html">scope_resource&lt;1 &lt;&lt; 10&gt;</a>();</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;         <span class="comment">// other不含有的边会在contract中自动删除</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;         <span class="keyword">auto</span> contract_names = <a class="code" href="namespaceTAT_1_1pmr.html#a585ff764333557a89bfa554774c2d16c">pmr::set&lt;std::tuple&lt;Name, Name&gt;</a>&gt;();</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; i : <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            contract_names.insert({i, i});</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;         }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ab926afb993eff5213b7d8ebc01fe8b2b">contract</a>(other, std::move(contract_names));</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ac9d58b022a6f1eaa0dfb74dcb145eb31">  605</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#ac9d58b022a6f1eaa0dfb74dcb145eb31">contract_all_edge</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ac9d58b022a6f1eaa0dfb74dcb145eb31">contract_all_edge</a>(<a class="code" href="structTAT_1_1Tensor.html#ab1e8b48602667685790b72681050af1c">conjugate</a>());</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> SetNameAndName = pmr::set&lt;std::tuple&lt;Name, Name&gt;&gt;&gt;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a050e1cb6440468b5264f0ed45abd41da">identity</a>(<span class="keyword">const</span> SetNameAndName&amp; pairs) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> SetNameAndName = pmr::set&lt;std::tuple&lt;Name, Name&gt;&gt;&gt;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a4b4e9c6d714d4b6c04712a7afae9b85c">exponential</a>(<span class="keyword">const</span> SetNameAndName&amp; pairs, <span class="keywordtype">int</span> step = 2) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#ab1e8b48602667685790b72681050af1c">conjugate</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> SetNameAndName = pmr::set&lt;std::tuple&lt;Name, Name&gt;&gt;&gt;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#ab58e7c3a2c618c32bcfc9c43c0089f67">trace</a>(<span class="keyword">const</span> SetNameAndName&amp; trace_names) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#a8ae719096b85159cda723101729ee703">SingularType</a> =</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">#ifdef TAT_USE_SINGULAR_MATRIX</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <a class="code" href="structTAT_1_1Singular.html">Singular&lt;ScalarType, Symmetry, Name&gt;</a></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00639"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a8ae719096b85159cda723101729ee703">  639</a></span>&#160;            ;</div>
<div class="line"><a name="l00644"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1svd__result.html">  644</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structTAT_1_1Tensor_1_1svd__result.html">svd_result</a> {</div>
<div class="line"><a name="l00645"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1svd__result.html#af065d89636ad3faf3dfdf1a50fd21027">  645</a></span>&#160;         <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor_1_1svd__result.html#af065d89636ad3faf3dfdf1a50fd21027">U</a>;</div>
<div class="line"><a name="l00646"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1svd__result.html#a8b3bc9309ca0b57b20fce17a33b189e4">  646</a></span>&#160;         <a class="code" href="structTAT_1_1Singular.html">SingularType</a> <a class="code" href="structTAT_1_1Tensor_1_1svd__result.html#a8b3bc9309ca0b57b20fce17a33b189e4">S</a>;</div>
<div class="line"><a name="l00647"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1svd__result.html#a4645d1561dd1e20f86c04b78a59ab71f">  647</a></span>&#160;         <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor_1_1svd__result.html#a4645d1561dd1e20f86c04b78a59ab71f">V</a>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      };</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1qr__result.html">  653</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structTAT_1_1Tensor_1_1qr__result.html">qr_result</a> {</div>
<div class="line"><a name="l00654"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1qr__result.html#aa9f51c7bc41beea03c94dc62fd1f085c">  654</a></span>&#160;         <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor_1_1qr__result.html#aa9f51c7bc41beea03c94dc62fd1f085c">Q</a>;</div>
<div class="line"><a name="l00655"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1qr__result.html#a821277cf48976ebc7d7204a725cb4056">  655</a></span>&#160;         <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor_1_1qr__result.html#a821277cf48976ebc7d7204a725cb4056">R</a>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      };</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#aa827a3d73c6b1517abf7e5c1f472561f">multiple</a>(<span class="keyword">const</span> <a class="code" href="structTAT_1_1Singular.html">SingularType</a>&amp; S, <span class="keyword">const</span> <a class="code" href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">Name</a>&amp; name, <span class="keywordtype">char</span> direction, <span class="keywordtype">bool</span> division = <span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> SetName = pmr::set&lt;Name&gt;&gt;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor_1_1svd__result.html">svd_result</a></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a111c41cd0cd24f4f516e44ff904e620a">svd</a>(<span class="keyword">const</span> SetName&amp; free_name_set_u,</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">Name</a>&amp; common_name_u,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">Name</a>&amp; common_name_v,</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          <a class="code" href="group__Miscellaneous.html#ga165aa7ea040b184dc85762582d2b5a9c">Size</a> cut = <a class="code" href="group__Miscellaneous.html#ga165aa7ea040b184dc85762582d2b5a9c">Size</a>(-1),</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">Name</a>&amp; singular_name_u = <a class="code" href="structTAT_1_1InternalName.html">InternalName&lt;Name&gt;::SVD_U</a>,</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">Name</a>&amp; singular_name_v = <a class="code" href="structTAT_1_1InternalName.html">InternalName&lt;Name&gt;::SVD_V</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> SetName = pmr::set&lt;Name&gt;&gt;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor_1_1qr__result.html">qr_result</a> <a class="code" href="structTAT_1_1Tensor.html#a7ec63ae19ef65473a16821b49ff0bf3d">qr</a>(<span class="keywordtype">char</span> free_name_direction, <span class="keyword">const</span> SetName&amp; free_name_set, <span class="keyword">const</span> <a class="code" href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">Name</a>&amp; common_name_q, <span class="keyword">const</span> <a class="code" href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">Name</a>&amp; common_name_r) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="preprocessor">#ifdef TAT_USE_MPI</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      [[deprecated(<span class="stringliteral">&quot;TAT::Tensor::send deprecated, use TAT::mpi.send instead&quot;</span>)]] <span class="keywordtype">void</span> <a class="code" href="structTAT_1_1Tensor.html#ab409a6f2d8f3ea1812b65a240ba5280c">send</a>(<span class="keywordtype">int</span> destination) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      [[deprecated(<span class="stringliteral">&quot;TAT::Tensor::receive deprecated, use TAT::mpi.receive instead&quot;</span>)]] <span class="keyword">static</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#ad208b0c8577ff1d5fed6a2b2c945698e">receive</a>(<span class="keywordtype">int</span> source);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      [[deprecated(<span class="stringliteral">&quot;TAT::Tensor::send_receive deprecated, use TAT::mpi.send_receive instead&quot;</span>)]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ae4cdde69a41a39bdd528983f775ce9a1">send_receive</a>(<span class="keywordtype">int</span> source, <span class="keywordtype">int</span> destination) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      [[deprecated(<span class="stringliteral">&quot;TAT::Tensor::broadcast deprecated, use TAT::mpi.broadcast instead&quot;</span>)]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a6cd35ca572f1bec93ba43b4a9de5e69d">broadcast</a>(<span class="keywordtype">int</span> root) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Func&gt;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      [[deprecated(<span class="stringliteral">&quot;TAT::Tensor::reduce deprecated, use TAT::mpi.reduce instead&quot;</span>)]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ab2117eb5c897ed1ac6a42807966e372d">reduce</a>(<span class="keywordtype">int</span> root, Func&amp;&amp; <span class="keyword">function</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      [[deprecated(<span class="stringliteral">&quot;TAT::Tensor::barrier deprecated, use TAT::mpi.barrier instead&quot;</span>)]] <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structTAT_1_1Tensor.html#a9b5d2765c5e944925af511d75c5a7690">barrier</a>();</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">       * 对各个进程但张量通过求和进行reduce</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a913bb31e5ca738fb74f646e5512a4c36">  731</a></span>&#160;      [[deprecated(<span class="stringliteral">&quot;TAT::Tensor::summary deprecated, reduce directly&quot;</span>)]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a913bb31e5ca738fb74f646e5512a4c36">summary</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ab2117eb5c897ed1ac6a42807966e372d">reduce</a>(root, [](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; tensor_1, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tensor_2) { <span class="keywordflow">return</span> tensor_1 + tensor_2; });</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      };</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="group__IO.html#ga49ae6a33f427b718575a001beaa4c3b8">meta_put</a>(std::ostream&amp;) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="group__IO.html#ga8e5484f651844dffccddb98f69248f69">data_put</a>(std::ostream&amp;) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="group__IO.html#ga064bded492880e88045141844fe30ec1">meta_get</a>(std::istream&amp;);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="group__IO.html#ga324fca0e2b2ab0e6e4524bda982788fd">data_get</a>(std::istream&amp;);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      [[nodiscard]] std::string <a class="code" href="group__IO.html#ga5f350c294d755e5988a4d1d815770bca">show</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      [[nodiscard]] std::string <a class="code" href="group__IO.html#ga59ec761051073a9191f308e42042a515">dump</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#a202ef1071a4e51b6344395ffbad6f1b8">load</a>(<span class="keyword">const</span> std::string&amp;) &amp;;</div>
<div class="line"><a name="l00744"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#adccf842a212e8fb6b64cdf6585d2619e">  744</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#adccf842a212e8fb6b64cdf6585d2619e">load</a>(<span class="keyword">const</span> std::string&amp; <span class="keywordtype">string</span>) &amp;&amp; {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Tensor.html#a202ef1071a4e51b6344395ffbad6f1b8">load</a>(<span class="keywordtype">string</span>));</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      };</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;   };</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tensor1, <span class="keyword">typename</span> Tensor2, <span class="keyword">typename</span> SetNameAndName = pmr::set&lt;std::tuple&lt;<span class="keyword">typename</span> Tensor1::name_t, <span class="keyword">typename</span> Tensor2::name_t&gt;&gt;&gt;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   [[nodiscard]] <span class="keyword">auto</span> contract(<span class="keyword">const</span> Tensor1&amp; tensor_1, <span class="keyword">const</span> Tensor2&amp; tensor_2, SetNameAndName&amp;&amp; contract_names) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keywordflow">return</span> tensor_1.contract(tensor_2, std::forward&lt;SetNameAndName&gt;(contract_names));</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ScalarType, <span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Name&gt;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <span class="keyword">struct </span>TensorShape {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      Tensor&lt;ScalarType, Symmetry, Name&gt;* owner;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   };</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <span class="comment">// TODO: middle 用edge operator表示一个待计算的张量, 在contract中用到</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;   <span class="comment">// 因为contract的操作是这样的</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   <span class="comment">// merge gemm split</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   <span class="comment">// 上一次split可以和下一次的merge合并</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   <span class="comment">// 比较重要， 可以大幅减少对称性张量的分块</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <span class="comment">/*</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">   template&lt;typename ScalarType, typename Symmetry, typename Name&gt;</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">   struct QuasiTensor {</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">      Tensor&lt;ScalarType, Symmetry, Name&gt; tensor;</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">      std::map&lt;Name, std::vector&lt;std::tuple&lt;Name, BoseEdge&lt;Symmetry&gt;&gt;&gt;&gt; split_map;</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">      std::set&lt;Name&gt; reversed_set;</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">      std::vector&lt;Name&gt; res_name;</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">      QuasiTensor</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">      operator Tensor&lt;ScalarType, Symmetry, Name&gt;() &amp;&amp; {</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">         return tensor.edge_operator({}, split_map, reversed_set, {}, std::move(res_name));</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">      operator Tensor&lt;ScalarType, Symmetry, Name&gt;() const&amp; {</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">         return tensor.edge_operator({}, split_map, reversed_set, {}, res_name);</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">      Tensor&lt;ScalarType, Symmetry, Name&gt; merge_again(</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">            const std::set&lt;Name&gt;&amp; merge_reversed_set,</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">            const std::map&lt;Name, std::vector&lt;Name&gt;&gt;&amp; merge_map,</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">            std::vector&lt;Name&gt;&amp;&amp; merge_res_name,</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">            std::set&lt;Name&gt;&amp; split_parity_mark,</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">            std::set&lt;Name&gt;&amp; merge_parity_mark) {</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">         auto total_reversed_set = reversed_set; // merge_reversed_set</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">         return tensor.edge_operator(</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">               {},</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">               split_map,</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">               total_reversed_set,</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">               merge_map,</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">               merge_res_name,</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">               false,</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">               {{{}, split_parity_mark, {}, merge_parity_mark}});</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">      QuasiTensor&lt;ScalarType, Symmetry, Name&gt;</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">   };</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   <span class="comment">// TODO: lazy framework</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   <span class="comment">// 看一下idris是如何做的</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   <span class="comment">// 需要考虑深搜不可行的问题</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <span class="comment">// 支持inplace操作</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;} <span class="comment">// namespace TAT</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="astructTAT_1_1Tensor_html_ae834de3ebb8d1ad7324561831bab33f0"><div class="ttname"><a href="structTAT_1_1Tensor.html#ae834de3ebb8d1ad7324561831bab33f0">TAT::Tensor::const_at</a></div><div class="ttdeci">const ScalarType &amp; const_at(const MapNameEdgePoint &amp;position) const &amp;</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1svd__result_html_a4645d1561dd1e20f86c04b78a59ab71f"><div class="ttname"><a href="structTAT_1_1Tensor_1_1svd__result.html#a4645d1561dd1e20f86c04b78a59ab71f">TAT::Tensor::svd_result::V</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; V</div><div class="ttdef"><b>Definition:</b> tensor.hpp:647</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a04b37643797ad7da56f258c2996a4135"><div class="ttname"><a href="structTAT_1_1Tensor.html#a04b37643797ad7da56f258c2996a4135">TAT::Tensor&lt; T &gt;::symmetry_valid</a></div><div class="ttdeci">std::enable_if_t&lt; is_symmetry_v&lt; NoSymmetry &gt; &gt; symmetry_valid</div><div class="ttdef"><b>Definition:</b> tensor.hpp:124</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a6cb81dfbd5808d32766b0acf5a60a9aa"><div class="ttname"><a href="structTAT_1_1Tensor.html#a6cb81dfbd5808d32766b0acf5a60a9aa">TAT::Tensor::norm</a></div><div class="ttdeci">real_base_t&lt; ScalarType &gt; norm() const</div><div class="ttdoc">求张量的模, 是拉平看作向量的模, 并不是矩阵模之类的东西</div><div class="ttdef"><b>Definition:</b> tensor.hpp:417</div></div>
<div class="ttc" id="anamespaceTAT_1_1pmr_html_a585ff764333557a89bfa554774c2d16c"><div class="ttname"><a href="namespaceTAT_1_1pmr.html#a585ff764333557a89bfa554774c2d16c">TAT::pmr::set</a></div><div class="ttdeci">std::set&lt; Key, Compare, polymorphic_allocator&lt; Key &gt; &gt; set</div><div class="ttdef"><b>Definition:</b> pmr_resource.hpp:243</div></div>
<div class="ttc" id="astructTAT_1_1NoSymmetry_html"><div class="ttname"><a href="structTAT_1_1NoSymmetry.html">TAT::NoSymmetry</a></div><div class="ttdoc">无对称性</div><div class="ttdef"><b>Definition:</b> symmetry.hpp:177</div></div>
<div class="ttc" id="astructTAT_1_1Core_html"><div class="ttname"><a href="structTAT_1_1Core.html">TAT::Core</a></div><div class="ttdoc">记录了张量的核心数据的类型, 核心数据指的是除了角标名称之外的信息, 包括边的形状, 以及张量内本身的数据</div><div class="ttdef"><b>Definition:</b> core.hpp:110</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1qr__result_html"><div class="ttname"><a href="structTAT_1_1Tensor_1_1qr__result.html">TAT::Tensor::qr_result</a></div><div class="ttdoc">张量qr的结果类型</div><div class="ttdef"><b>Definition:</b> tensor.hpp:653</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab409a6f2d8f3ea1812b65a240ba5280c"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab409a6f2d8f3ea1812b65a240ba5280c">TAT::Tensor::send</a></div><div class="ttdeci">void send(int destination) const</div><div class="ttdoc">source调用此函数, 向destination发送一个张量</div><div class="ttdef"><b>Definition:</b> mpi.hpp:278</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a202ef1071a4e51b6344395ffbad6f1b8"><div class="ttname"><a href="structTAT_1_1Tensor.html#a202ef1071a4e51b6344395ffbad6f1b8">TAT::Tensor::load</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; load(const std::string &amp;) &amp;</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a529084aace9257dd27b0b61bde589888"><div class="ttname"><a href="structTAT_1_1Tensor.html#a529084aace9257dd27b0b61bde589888">TAT::Tensor&lt; T &gt;::name_valid</a></div><div class="ttdeci">std::enable_if_t&lt; is_name_v&lt; DefaultName &gt; &gt; name_valid</div><div class="ttdef"><b>Definition:</b> tensor.hpp:125</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a631e4cbdf89566dcb8dd525f9648bc65"><div class="ttname"><a href="structTAT_1_1Singular.html#a631e4cbdf89566dcb8dd525f9648bc65">TAT::Singular::value</a></div><div class="ttdeci">singular_map value</div><div class="ttdef"><b>Definition:</b> tensor.hpp:59</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a970d6dea974e504dad24237d31f5e998"><div class="ttname"><a href="structTAT_1_1Tensor.html#a970d6dea974e504dad24237d31f5e998">TAT::Tensor::contract</a></div><div class="ttdeci">static auto contract(const Tensor&lt; ScalarType1, Symmetry, Name &gt; &amp;tensor_1, const Tensor&lt; ScalarType2, Symmetry, Name &gt; &amp;tensor_2, SetNameAndName &amp;&amp;contract_names)</div><div class="ttdef"><b>Definition:</b> tensor.hpp:557</div></div>
<div class="ttc" id="anamespacesquare_html_a38e8aadaa8b92f8927c15bef40111b7a"><div class="ttname"><a href="namespacesquare.html#a38e8aadaa8b92f8927c15bef40111b7a">square::real</a></div><div class="ttdeci">TAT::real_base_t&lt; T &gt; real</div><div class="ttdef"><b>Definition:</b> basic.hpp:41</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a6cd35ca572f1bec93ba43b4a9de5e69d"><div class="ttname"><a href="structTAT_1_1Tensor.html#a6cd35ca572f1bec93ba43b4a9de5e69d">TAT::Tensor::broadcast</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; broadcast(int root) const</div><div class="ttdoc">从root进程分发张量, 使用简单的树形分发, 必须所有进程一起调用这个函数</div><div class="ttdef"><b>Definition:</b> mpi.hpp:293</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a9a4807a3020bf392da21d2b744bb7aa7"><div class="ttname"><a href="structTAT_1_1Singular.html#a9a4807a3020bf392da21d2b744bb7aa7">TAT::Singular::copy</a></div><div class="ttdeci">Singular&lt; ScalarType, Symmetry, Name &gt; copy() const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:94</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a444f0f89149df8858c2583ab833aa2f4"><div class="ttname"><a href="structTAT_1_1Tensor.html#a444f0f89149df8858c2583ab833aa2f4">TAT::Tensor::edge_rename</a></div><div class="ttdeci">auto edge_rename(const MapNameName &amp;dictionary) const</div><div class="ttdoc">对张量边的名称进行重命名</div><div class="ttdef"><b>Definition:</b> edge_miscellaneous.hpp:29</div></div>
<div class="ttc" id="anamespacesquare_html_a99ed7df90aa2e44afa0d7471513d7ab9"><div class="ttname"><a href="namespacesquare.html#a99ed7df90aa2e44afa0d7471513d7ab9">square::Name</a></div><div class="ttdeci">TAT::DefaultName Name</div><div class="ttdef"><b>Definition:</b> basic.hpp:37</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1qr__result_html_a821277cf48976ebc7d7204a725cb4056"><div class="ttname"><a href="structTAT_1_1Tensor_1_1qr__result.html#a821277cf48976ebc7d7204a725cb4056">TAT::Tensor::qr_result::R</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; R</div><div class="ttdef"><b>Definition:</b> tensor.hpp:655</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab1e8b48602667685790b72681050af1c"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab1e8b48602667685790b72681050af1c">TAT::Tensor::conjugate</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; conjugate() const</div><div class="ttdoc">生成张量的共轭张量</div><div class="ttdef"><b>Definition:</b> tensor_miscellaneous.hpp:127</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ae76f569d5a096ccc07f2977a96d5d7b6"><div class="ttname"><a href="structTAT_1_1Tensor.html#ae76f569d5a096ccc07f2977a96d5d7b6">TAT::Tensor::one</a></div><div class="ttdeci">static Tensor&lt; ScalarType, Symmetry, Name &gt; one(ScalarType number, const VectorName &amp;names_init, const VectorSymmetry &amp;edge_symmetry={}, const VectorArrow &amp;edge_arrow={})</div><div class="ttdoc">创建高秩但是元素只有一个的张量</div><div class="ttdef"><b>Definition:</b> tensor.hpp:214</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a9d94cc5a258afdf3b256779df8a8bd9b"><div class="ttname"><a href="structTAT_1_1Tensor.html#a9d94cc5a258afdf3b256779df8a8bd9b">TAT::Tensor::copy</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; copy() const</div><div class="ttdoc">张量的复制, 默认的赋值和复制初始化不会拷贝数据，而会共用core</div><div class="ttdef"><b>Definition:</b> tensor.hpp:174</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a9b5d2765c5e944925af511d75c5a7690"><div class="ttname"><a href="structTAT_1_1Tensor.html#a9b5d2765c5e944925af511d75c5a7690">TAT::Tensor::barrier</a></div><div class="ttdeci">static void barrier()</div><div class="ttdoc">mpi进程间同步</div><div class="ttdef"><b>Definition:</b> mpi.hpp:304</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ae4cdde69a41a39bdd528983f775ce9a1"><div class="ttname"><a href="structTAT_1_1Tensor.html#ae4cdde69a41a39bdd528983f775ce9a1">TAT::Tensor::send_receive</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; send_receive(int source, int destination) const</div><div class="ttdoc">像简单类型一样使用mpi但send和receive, 调用后, 一个destination返回source调用时输入tensor, 其他进程返回空张量</div><div class="ttdef"><b>Definition:</b> mpi.hpp:288</div></div>
<div class="ttc" id="astructTAT_1_1fake__map_html"><div class="ttname"><a href="structTAT_1_1fake__map.html">TAT::fake_map</a></div><div class="ttdoc">只有一个元素的假map</div><div class="ttdef"><b>Definition:</b> edge.hpp:42</div></div>
<div class="ttc" id="anamespaceTAT_1_1pmr_html_ac746848942f6f83b133482f63b1fd320"><div class="ttname"><a href="namespaceTAT_1_1pmr.html#ac746848942f6f83b133482f63b1fd320">TAT::pmr::map</a></div><div class="ttdeci">std::map&lt; Key, T, Compare, polymorphic_allocator&lt; std::pair&lt; const Key, T &gt; &gt;&gt; map</div><div class="ttdef"><b>Definition:</b> pmr_resource.hpp:240</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html"><div class="ttname"><a href="structTAT_1_1Singular.html">TAT::Singular</a></div><div class="ttdoc">张量看成矩阵后做svd分解后得到的奇异值类型, 为对角矩阵形式的张量</div><div class="ttdef"><b>Definition:</b> tensor.hpp:51</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a2836a28ed1deb986d2033b7e63f805dd"><div class="ttname"><a href="structTAT_1_1Tensor.html#a2836a28ed1deb986d2033b7e63f805dd">TAT::Tensor::transpose</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; transpose(const VectorName &amp;target_names) const</div><div class="ttdoc">对张量进行转置</div><div class="ttdef"><b>Definition:</b> edge_miscellaneous.hpp:52</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a696aaccadd2f6ff256bdaa24ffe4f9e2"><div class="ttname"><a href="structTAT_1_1Tensor.html#a696aaccadd2f6ff256bdaa24ffe4f9e2">TAT::Tensor::map</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; map(Function &amp;&amp;function) const</div><div class="ttdoc">对张量的每个数据元素做同样的非原地的变换</div><div class="ttdef"><b>Definition:</b> tensor.hpp:269</div></div>
<div class="ttc" id="aname_8hpp_html"><div class="ttname"><a href="name_8hpp.html">name.hpp</a></div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a1acbadd2866fc14ef81b549cd25b2686"><div class="ttname"><a href="structTAT_1_1Singular.html#a1acbadd2866fc14ef81b549cd25b2686">TAT::Singular::load</a></div><div class="ttdeci">Singular&lt; ScalarType, Symmetry, Name &gt; &amp; load(const std::string &amp;) &amp;</div></div>
<div class="ttc" id="agroup__Miscellaneous_html_ga78326bee7cc963cd2d165718de5c0465"><div class="ttname"><a href="group__Miscellaneous.html#ga78326bee7cc963cd2d165718de5c0465">TAT::Arrow</a></div><div class="ttdeci">bool Arrow</div><div class="ttdoc">费米箭头方向的类型, false和true分别表示出入</div><div class="ttdef"><b>Definition:</b> basic_type.hpp:71</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a5f9629c5b510af787335c696b98198bb"><div class="ttname"><a href="structTAT_1_1Tensor.html#a5f9629c5b510af787335c696b98198bb">TAT::Tensor::contract</a></div><div class="ttdeci">auto contract(const Tensor&lt; OtherScalarType, Symmetry, Name &gt; &amp;tensor_2, SetNameAndName &amp;&amp;contract_names) const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:582</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_aae145191f04bc2ce554e695b748d260c"><div class="ttname"><a href="structTAT_1_1Tensor.html#aae145191f04bc2ce554e695b748d260c">TAT::Tensor::shrink</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; shrink(const ShrinkConfigure &amp;configure, const Name &amp;new_name=InternalName&lt; Name &gt;::No_New_Name, Arrow arrow=false) const</div><div class="ttdef"><b>Definition:</b> shrink_and_expand.hpp:99</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_af8cbdc992c718c5eba66e7f775969d83"><div class="ttname"><a href="structTAT_1_1Tensor.html#af8cbdc992c718c5eba66e7f775969d83">TAT::Tensor::slice</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; slice(const pmr::map&lt; Name, EdgePoint &gt; &amp;configure, const Name &amp;new_name=InternalName&lt; Name &gt;::No_New_Name, Arrow arrow=false) const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:250</div></div>
<div class="ttc" id="agroup__IO_html_ga49ae6a33f427b718575a001beaa4c3b8"><div class="ttname"><a href="group__IO.html#ga49ae6a33f427b718575a001beaa4c3b8">TAT::Tensor::meta_put</a></div><div class="ttdeci">const Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; meta_put(std::ostream &amp;) const</div><div class="ttdef"><b>Definition:</b> io.hpp:565</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab102bd3898b58fff24b10ed07f3221e6"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab102bd3898b58fff24b10ed07f3221e6">TAT::Tensor::to</a></div><div class="ttdeci">Tensor&lt; OtherScalarType, Symmetry, Name &gt; to() const</div><div class="ttdoc">不同标量类型的张量之间的转换函数</div><div class="ttdef"><b>Definition:</b> tensor.hpp:383</div></div>
<div class="ttc" id="agroup__Miscellaneous_html_ga165aa7ea040b184dc85762582d2b5a9c"><div class="ttname"><a href="group__Miscellaneous.html#ga165aa7ea040b184dc85762582d2b5a9c">TAT::Size</a></div><div class="ttdeci">std::uint64_t Size</div><div class="ttdoc">张量数据维度大小和数据本身大小的类型</div><div class="ttdef"><b>Definition:</b> basic_type.hpp:53</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_aa827a3d73c6b1517abf7e5c1f472561f"><div class="ttname"><a href="structTAT_1_1Tensor.html#aa827a3d73c6b1517abf7e5c1f472561f">TAT::Tensor::multiple</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; multiple(const SingularType &amp;S, const Name &amp;name, char direction, bool division=false) const</div><div class="ttdoc">张量缩并上SVD产生的奇异值数据, 就地操作</div><div class="ttdef"><b>Definition:</b> tensor_miscellaneous.hpp:50</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a99633cbb2776da691ad804a23f8e7d99"><div class="ttname"><a href="structTAT_1_1Tensor.html#a99633cbb2776da691ad804a23f8e7d99">TAT::Tensor::contract_all_edge</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; contract_all_edge(const Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;other) const</div><div class="ttdoc">将一个张量与另一个张量的所有相同名称的边进行缩并</div><div class="ttdef"><b>Definition:</b> tensor.hpp:591</div></div>
<div class="ttc" id="agroup__Miscellaneous_html_ga40f46f83982bd27a7e204d8a1360b6a0"><div class="ttname"><a href="group__Miscellaneous.html#ga40f46f83982bd27a7e204d8a1360b6a0">TAT::TAT_error</a></div><div class="ttdeci">void TAT_error(const char *message)</div><div class="ttdoc">TAT使用的抛出运行时异常</div><div class="ttdef"><b>Definition:</b> mpi.hpp:336</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a61ddce75b3513e9d6ac7f494ae0bc04d"><div class="ttname"><a href="structTAT_1_1Tensor.html#a61ddce75b3513e9d6ac7f494ae0bc04d">TAT::Tensor::const_block</a></div><div class="ttdeci">const auto &amp; const_block(const MapNameSymmetry &amp;position={}) const &amp;</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_aff05894668cca4af943c6dfa4eecaa59"><div class="ttname"><a href="structTAT_1_1Tensor.html#aff05894668cca4af943c6dfa4eecaa59">TAT::Tensor::shape</a></div><div class="ttdeci">TensorShape&lt; ScalarType, Symmetry, Name &gt; shape()</div><div class="ttdef"><b>Definition:</b> tensor.hpp:150</div></div>
<div class="ttc" id="astructTAT_1_1FastName_html"><div class="ttname"><a href="structTAT_1_1FastName.html">TAT::FastName</a></div><div class="ttdoc">用于给张量的边命名的类型FastName, 新建FastName的时候可以选定标号, 也可以选定字符串作为名称, FastName将自动保证标号和名称的一一对应</div><div class="ttdef"><b>Definition:</b> name.hpp:81</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1svd__result_html"><div class="ttname"><a href="structTAT_1_1Tensor_1_1svd__result.html">TAT::Tensor::svd_result</a></div><div class="ttdoc">张量svd的结果类型</div><div class="ttdef"><b>Definition:</b> tensor.hpp:644</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a0fe4f7437b71de7367ca2623a2111aaa"><div class="ttname"><a href="structTAT_1_1Tensor.html#a0fe4f7437b71de7367ca2623a2111aaa">TAT::Tensor::test</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; test(ScalarType first=0, ScalarType step=1) &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:340</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a03674ac4734f948d48574ba39b2f6103"><div class="ttname"><a href="structTAT_1_1Tensor.html#a03674ac4734f948d48574ba39b2f6103">TAT::Tensor::edge_operator</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; edge_operator(const MapNameName &amp;rename_map, const MapNameVectorNameAndEdge &amp;split_map, const SetName1 &amp;reversed_name, const MapNameVectorName &amp;merge_map, const VectorName &amp;new_names, bool apply_parity=false, const std::array&lt; SetName2, 4 &gt; &amp;parity_exclude_name={{{}, {}, {}, {}}}, const MapNameMapSymmetrySize &amp;edge_and_symmetries_to_cut_before_all={}) const</div><div class="ttdoc">对张量的边进行操作的中枢函数, 对边依次做重命名, 分裂, 费米箭头取反, 合并, 转置的操作,</div><div class="ttdef"><b>Definition:</b> edge_operator.hpp:54</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_aba744a831384ea24fda823bf598ad7c1"><div class="ttname"><a href="structTAT_1_1Tensor.html#aba744a831384ea24fda823bf598ad7c1">TAT::Tensor::block</a></div><div class="ttdeci">const auto &amp; block(const MapNameSymmetry &amp;position={}) const &amp;</div><div class="ttdoc">获取张量的某个分块</div><div class="ttdef"><b>Definition:</b> tensor.hpp:351</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ae4e2dc387e53f06a2012b08daa851a06"><div class="ttname"><a href="structTAT_1_1Tensor.html#ae4e2dc387e53f06a2012b08daa851a06">TAT::Tensor::core</a></div><div class="ttdeci">propagate_const_shared_ptr&lt; Core&lt; ScalarType, Symmetry &gt; &gt; core</div><div class="ttdoc">张量中出了边名称外的其他数据</div><div class="ttdef"><b>Definition:</b> tensor.hpp:148</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a2a95bf05974e36d8109a1b0ec695edac"><div class="ttname"><a href="structTAT_1_1Tensor.html#a2a95bf05974e36d8109a1b0ec695edac">TAT::Tensor::transform</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; transform(Function &amp;&amp;function) &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:296</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a25052984c028c2913d77fc0ed079f02d"><div class="ttname"><a href="structTAT_1_1Tensor.html#a25052984c028c2913d77fc0ed079f02d">TAT::Tensor::zero</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; zero() &amp;</div><div class="ttdoc">将张量内的数据全部设置为零</div><div class="ttdef"><b>Definition:</b> tensor.hpp:321</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1svd__result_html_a8b3bc9309ca0b57b20fce17a33b189e4"><div class="ttname"><a href="structTAT_1_1Tensor_1_1svd__result.html#a8b3bc9309ca0b57b20fce17a33b189e4">TAT::Tensor::svd_result::S</a></div><div class="ttdeci">SingularType S</div><div class="ttdef"><b>Definition:</b> tensor.hpp:646</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_aff45c9ef8b017796d20055023e732a28"><div class="ttname"><a href="structTAT_1_1Tensor.html#aff45c9ef8b017796d20055023e732a28">TAT::Tensor&lt; T &gt;::EdgePointWithArrow</a></div><div class="ttdeci">std::conditional_t&lt; std::is_same_v&lt; NoSymmetry, NoSymmetry &gt;, std::tuple&lt; Size, Size &gt;, std::conditional_t&lt; is_fermi_symmetry_v&lt; NoSymmetry &gt;, std::tuple&lt; Arrow, NoSymmetry, Size, Size &gt;, std::tuple&lt; NoSymmetry, Size, Size &gt; &gt;&gt; EdgePointWithArrow</div><div class="ttdef"><b>Definition:</b> tensor.hpp:239</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a070c446e688bad4dd586b4e5f23ebb6c"><div class="ttname"><a href="structTAT_1_1Tensor.html#a070c446e688bad4dd586b4e5f23ebb6c">TAT::Tensor::test</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; test(ScalarType first=0, ScalarType step=1) &amp;</div><div class="ttdoc">将张量内的数据设置为便于测试的值</div><div class="ttdef"><b>Definition:</b> tensor.hpp:333</div></div>
<div class="ttc" id="aedge_8hpp_html"><div class="ttname"><a href="edge_8hpp.html">edge.hpp</a></div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a4b4e9c6d714d4b6c04712a7afae9b85c"><div class="ttname"><a href="structTAT_1_1Tensor.html#a4b4e9c6d714d4b6c04712a7afae9b85c">TAT::Tensor::exponential</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; exponential(const SetNameAndName &amp;pairs, int step=2) const</div><div class="ttdoc">看作矩阵后求出矩阵指数</div><div class="ttdef"><b>Definition:</b> exponential.hpp:152</div></div>
<div class="ttc" id="abasic__type_8hpp_html"><div class="ttname"><a href="basic__type_8hpp.html">basic_type.hpp</a></div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a8ae719096b85159cda723101729ee703"><div class="ttname"><a href="structTAT_1_1Tensor.html#a8ae719096b85159cda723101729ee703">TAT::Tensor::SingularType</a></div><div class="ttdeci">Singular&lt; ScalarType, Symmetry, Name &gt; SingularType</div><div class="ttdef"><b>Definition:</b> tensor.hpp:639</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab2704312b6957e2fa2c1f4636449032c"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab2704312b6957e2fa2c1f4636449032c">TAT::Tensor::expand</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; expand(const ExpandConfigure &amp;configure, const Name &amp;old_name=InternalName&lt; Name &gt;::No_Old_Name) const</div><div class="ttdef"><b>Definition:</b> shrink_and_expand.hpp:29</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab2117eb5c897ed1ac6a42807966e372d"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab2117eb5c897ed1ac6a42807966e372d">TAT::Tensor::reduce</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; reduce(int root, Func &amp;&amp;function) const</div><div class="ttdoc">向root进程reduce张量, 使用简单的树形reduce, 必须所有进程一起调用这个函数, 最后root进程返回全部reduce的结果, 其他进程为中间结果一般无意义</div><div class="ttdef"><b>Definition:</b> mpi.hpp:299</div></div>
<div class="ttc" id="astructTAT_1_1InternalName_html"><div class="ttname"><a href="structTAT_1_1InternalName.html">TAT::InternalName</a></div><div class="ttdoc">对于每个将要被使用做Name的类型, 需要设置一部分保留类型</div><div class="ttdef"><b>Definition:</b> name.hpp:138</div></div>
<div class="ttc" id="apropagate__const_8hpp_html"><div class="ttname"><a href="propagate__const_8hpp.html">propagate_const.hpp</a></div></div>
<div class="ttc" id="anamespaceTAT_1_1pmr_html_a9a7e8d6310c5e03b7f1d016a4f5389d0"><div class="ttname"><a href="namespaceTAT_1_1pmr.html#a9a7e8d6310c5e03b7f1d016a4f5389d0">TAT::pmr::vector</a></div><div class="ttdeci">std::vector&lt; T, polymorphic_allocator&lt; T &gt; &gt; vector</div><div class="ttdef"><b>Definition:</b> pmr_resource.hpp:234</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ad4dca3481df8511db539e12297b8dc90"><div class="ttname"><a href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">TAT::Tensor::name_to_index</a></div><div class="ttdeci">std::map&lt; Name, Rank &gt; name_to_index</div><div class="ttdoc">张量边名称到边的序号的映射表</div><div class="ttdef"><b>Definition:</b> tensor.hpp:142</div></div>
<div class="ttc" id="astructTAT_1_1propagate__const__shared__ptr_html"><div class="ttname"><a href="structTAT_1_1propagate__const__shared__ptr.html">TAT::propagate_const_shared_ptr</a></div><div class="ttdef"><b>Definition:</b> propagate_const.hpp:30</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a111c41cd0cd24f4f516e44ff904e620a"><div class="ttname"><a href="structTAT_1_1Tensor.html#a111c41cd0cd24f4f516e44ff904e620a">TAT::Tensor::svd</a></div><div class="ttdeci">svd_result svd(const SetName &amp;free_name_set_u, const Name &amp;common_name_u, const Name &amp;common_name_v, Size cut=Size(-1), const Name &amp;singular_name_u=InternalName&lt; Name &gt;::SVD_U, const Name &amp;singular_name_v=InternalName&lt; Name &gt;::SVD_V) const</div><div class="ttdoc">对张量进行svd分解</div><div class="ttdef"><b>Definition:</b> svd.hpp:253</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a251207a171aed3995dda904fec5528f6"><div class="ttname"><a href="structTAT_1_1Singular.html#a251207a171aed3995dda904fec5528f6">TAT::Singular::fake_singular_map</a></div><div class="ttdeci">fake_map&lt; Symmetry, vector&lt; real_base_t&lt; ScalarType &gt; &gt;&gt; fake_singular_map</div><div class="ttdef"><b>Definition:</b> tensor.hpp:53</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a75826991f1d896a066b3bad29dd3e135"><div class="ttname"><a href="structTAT_1_1Tensor.html#a75826991f1d896a066b3bad29dd3e135">TAT::Tensor::Tensor</a></div><div class="ttdeci">Tensor(const VectorName &amp;names_init, const VectorEdge &amp;edges_init, const bool auto_reverse=false)</div><div class="ttdoc">根据张量边的名称和形状构造张量, 分块将自动根据对称性进行处理</div><div class="ttdef"><b>Definition:</b> tensor.hpp:162</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ac9d58b022a6f1eaa0dfb74dcb145eb31"><div class="ttname"><a href="structTAT_1_1Tensor.html#ac9d58b022a6f1eaa0dfb74dcb145eb31">TAT::Tensor::contract_all_edge</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; contract_all_edge() const</div><div class="ttdoc">张量与自己的共轭进行尽可能的缩并</div><div class="ttdef"><b>Definition:</b> tensor.hpp:605</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ae873994e0ed16334f85febd570ab4117"><div class="ttname"><a href="structTAT_1_1Tensor.html#ae873994e0ed16334f85febd570ab4117">TAT::Tensor::transform</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; transform(Function &amp;&amp;function) &amp;</div><div class="ttdoc">对张量的每个数据元素做同样的原地的变换</div><div class="ttdef"><b>Definition:</b> tensor.hpp:285</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ac7fa382fd250903d72418b8e10ed4a65"><div class="ttname"><a href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">TAT::Tensor::set</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; set(Generator &amp;&amp;generator) &amp;</div><div class="ttdoc">通过一个生成器设置一个张量内的数据</div><div class="ttdef"><b>Definition:</b> tensor.hpp:307</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a050e1cb6440468b5264f0ed45abd41da"><div class="ttname"><a href="structTAT_1_1Tensor.html#a050e1cb6440468b5264f0ed45abd41da">TAT::Tensor::identity</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; identity(const SetNameAndName &amp;pairs) const</div><div class="ttdoc">生成相同形状的单位张量</div><div class="ttdef"><b>Definition:</b> tensor_miscellaneous.hpp:213</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a15ae4dc3b9a92e28e5caa19348aa6611"><div class="ttname"><a href="structTAT_1_1Tensor.html#a15ae4dc3b9a92e28e5caa19348aa6611">TAT::Tensor&lt; T &gt;::scalar_t</a></div><div class="ttdeci">T scalar_t</div><div class="ttdef"><b>Definition:</b> tensor.hpp:128</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1svd__result_html_af065d89636ad3faf3dfdf1a50fd21027"><div class="ttname"><a href="structTAT_1_1Tensor_1_1svd__result.html#af065d89636ad3faf3dfdf1a50fd21027">TAT::Tensor::svd_result::U</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; U</div><div class="ttdef"><b>Definition:</b> tensor.hpp:645</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_aeffed0720af6620f8dbb60be83cdcfc5"><div class="ttname"><a href="structTAT_1_1Tensor.html#aeffed0720af6620f8dbb60be83cdcfc5">TAT::Tensor::at</a></div><div class="ttdeci">const ScalarType &amp; at(const MapNameEdgePoint &amp;position) const &amp;</div><div class="ttdoc">获取张量中某个分块内的某个元素</div><div class="ttdef"><b>Definition:</b> tensor.hpp:367</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a17de08d8837e04b110ae0d6ea2a90676"><div class="ttname"><a href="structTAT_1_1Singular.html#a17de08d8837e04b110ae0d6ea2a90676">TAT::Singular::norm</a></div><div class="ttdeci">real_base_t&lt; ScalarType &gt; norm() const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:62</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a2a45b860499d4eaa7829efd3bcbdb1e9"><div class="ttname"><a href="structTAT_1_1Tensor.html#a2a45b860499d4eaa7829efd3bcbdb1e9">TAT::Tensor::is_scalar</a></div><div class="ttdeci">bool is_scalar() const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:221</div></div>
<div class="ttc" id="astructTAT_1_1Edge_html"><div class="ttname"><a href="structTAT_1_1Edge.html">TAT::Edge&lt; NoSymmetry &gt;</a></div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab58e7c3a2c618c32bcfc9c43c0089f67"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab58e7c3a2c618c32bcfc9c43c0089f67">TAT::Tensor::trace</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; trace(const SetNameAndName &amp;trace_names) const</div><div class="ttdef"><b>Definition:</b> trace.hpp:30</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_aff3fe646de6b8d94251e0d8096cad12b"><div class="ttname"><a href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">TAT::Tensor::names</a></div><div class="ttdeci">std::vector&lt; Name &gt; names</div><div class="ttdoc">张量的边的名称</div><div class="ttdef"><b>Definition:</b> tensor.hpp:137</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a67773ad17527d10e1129478340cda72e"><div class="ttname"><a href="structTAT_1_1Tensor.html#a67773ad17527d10e1129478340cda72e">TAT::Tensor::is_valid</a></div><div class="ttdeci">bool is_valid() const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:182</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a2709db65768862bc9c5d05fa6686cb9a"><div class="ttname"><a href="structTAT_1_1Singular.html#a2709db65768862bc9c5d05fa6686cb9a">TAT::Singular::normal_map</a></div><div class="ttdeci">std::map&lt; Symmetry, vector&lt; real_base_t&lt; ScalarType &gt; &gt;&gt; normal_map</div><div class="ttdef"><b>Definition:</b> tensor.hpp:52</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ae63a2323a01a71dda38b8856cb5a532b"><div class="ttname"><a href="structTAT_1_1Tensor.html#ae63a2323a01a71dda38b8856cb5a532b">TAT::Tensor::zero</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; zero() &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:324</div></div>
<div class="ttc" id="astructTAT_1_1scope__resource_html"><div class="ttname"><a href="structTAT_1_1scope__resource.html">TAT::scope_resource</a></div><div class="ttdef"><b>Definition:</b> pmr_resource.hpp:252</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_abb9bf6205f203393f073d0b536778c2b"><div class="ttname"><a href="structTAT_1_1Tensor.html#abb9bf6205f203393f073d0b536778c2b">TAT::Tensor&lt; T &gt;::EdgePoint</a></div><div class="ttdeci">std::conditional_t&lt; std::is_same_v&lt; NoSymmetry, NoSymmetry &gt;, Size, std::tuple&lt; NoSymmetry, Size &gt; &gt; EdgePoint</div><div class="ttdef"><b>Definition:</b> tensor.hpp:235</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a9cc15c9afe143966029c1d0dc8fa6f91"><div class="ttname"><a href="structTAT_1_1Tensor.html#a9cc15c9afe143966029c1d0dc8fa6f91">TAT::Tensor&lt; T &gt;::scalar_valid</a></div><div class="ttdeci">std::enable_if_t&lt; is_scalar_v&lt; T &gt; &gt; scalar_valid</div><div class="ttdef"><b>Definition:</b> tensor.hpp:123</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a2c908557416bb3b3c72896320aa30106"><div class="ttname"><a href="structTAT_1_1Tensor.html#a2c908557416bb3b3c72896320aa30106">TAT::Tensor::set</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; set(Generator &amp;&amp;generator) &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:312</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab926afb993eff5213b7d8ebc01fe8b2b"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab926afb993eff5213b7d8ebc01fe8b2b">TAT::Tensor::contract</a></div><div class="ttdeci">static Tensor&lt; ScalarType, Symmetry, Name &gt; contract(const Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;tensor_1, const Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;tensor_2, SetNameAndName &amp;&amp;contract_names)</div><div class="ttdoc">两个张量的缩并运算</div><div class="ttdef"><b>Definition:</b> contract.hpp:283</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a67380e7a331cc50e526dc93cf7047531"><div class="ttname"><a href="structTAT_1_1Tensor.html#a67380e7a331cc50e526dc93cf7047531">TAT::Tensor::reverse_edge</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; reverse_edge(const SetName1 &amp;reversed_name, bool apply_parity=false, SetName2 &amp;&amp;parity_exclude_name={}) const</div><div class="ttdoc">将费米张量的一些边进行反转</div><div class="ttdef"><b>Definition:</b> edge_miscellaneous.hpp:59</div></div>
<div class="ttc" id="agroup__IO_html_ga064bded492880e88045141844fe30ec1"><div class="ttname"><a href="group__IO.html#ga064bded492880e88045141844fe30ec1">TAT::Tensor::meta_get</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; meta_get(std::istream &amp;)</div><div class="ttdef"><b>Definition:</b> io.hpp:612</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_adccf842a212e8fb6b64cdf6585d2619e"><div class="ttname"><a href="structTAT_1_1Tensor.html#adccf842a212e8fb6b64cdf6585d2619e">TAT::Tensor::load</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; load(const std::string &amp;string) &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:744</div></div>
<div class="ttc" id="apmr__resource_8hpp_html"><div class="ttname"><a href="pmr__resource_8hpp.html">pmr_resource.hpp</a></div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1qr__result_html_aa9f51c7bc41beea03c94dc62fd1f085c"><div class="ttname"><a href="structTAT_1_1Tensor_1_1qr__result.html#aa9f51c7bc41beea03c94dc62fd1f085c">TAT::Tensor::qr_result::Q</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; Q</div><div class="ttdef"><b>Definition:</b> tensor.hpp:654</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ac8040216c9eacaa2f5c61a6768bc0af3"><div class="ttname"><a href="structTAT_1_1Tensor.html#ac8040216c9eacaa2f5c61a6768bc0af3">TAT::Tensor::split_edge</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; split_edge(MapNameVectorNameAndEdge split, bool apply_parity=false, SetName &amp;&amp;parity_exclude_name_split={}) const</div><div class="ttdoc">分裂张量的一些边</div><div class="ttdef"><b>Definition:</b> edge_miscellaneous.hpp:127</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a2e1ca6a58056b952a50e3238ba2a533c"><div class="ttname"><a href="structTAT_1_1Tensor.html#a2e1ca6a58056b952a50e3238ba2a533c">TAT::Tensor::operator=</a></div><div class="ttdeci">Tensor &amp; operator=(const Tensor &amp;other)=default</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html"><div class="ttname"><a href="structTAT_1_1Tensor.html">TAT::Tensor</a></div><div class="ttdoc">张量类型</div><div class="ttdef"><b>Definition:</b> tensor.hpp:122</div></div>
<div class="ttc" id="agroup__IO_html_ga59ec761051073a9191f308e42042a515"><div class="ttname"><a href="group__IO.html#ga59ec761051073a9191f308e42042a515">TAT::Tensor::dump</a></div><div class="ttdeci">std::string dump() const</div><div class="ttdef"><b>Definition:</b> io.hpp:588</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a8419fd382c3d74ceafb7b9b06e0214ca"><div class="ttname"><a href="structTAT_1_1Tensor.html#a8419fd382c3d74ceafb7b9b06e0214ca">TAT::Tensor::same_shape</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; same_shape() const</div><div class="ttdoc">产生一个与自己形状一样的张量</div><div class="ttdef"><b>Definition:</b> tensor.hpp:258</div></div>
<div class="ttc" id="acore_8hpp_html"><div class="ttname"><a href="core_8hpp.html">core.hpp</a></div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ad208b0c8577ff1d5fed6a2b2c945698e"><div class="ttname"><a href="structTAT_1_1Tensor.html#ad208b0c8577ff1d5fed6a2b2c945698e">TAT::Tensor::receive</a></div><div class="ttdeci">static Tensor&lt; ScalarType, Symmetry, Name &gt; receive(int source)</div><div class="ttdoc">destination调用此函数, 从source接受一个张量</div><div class="ttdef"><b>Definition:</b> mpi.hpp:283</div></div>
<div class="ttc" id="asymmetry_8hpp_html"><div class="ttname"><a href="symmetry_8hpp.html">symmetry.hpp</a></div></div>
<div class="ttc" id="agroup__IO_html_ga8e5484f651844dffccddb98f69248f69"><div class="ttname"><a href="group__IO.html#ga8e5484f651844dffccddb98f69248f69">TAT::Tensor::data_put</a></div><div class="ttdeci">const Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; data_put(std::ostream &amp;) const</div><div class="ttdef"><b>Definition:</b> io.hpp:572</div></div>
<div class="ttc" id="anamespaceTAT_html"><div class="ttname"><a href="namespaceTAT.html">TAT</a></div><div class="ttdoc">TAT is A Tensor library</div><div class="ttdef"><b>Definition:</b> basic_type.hpp:28</div></div>
<div class="ttc" id="agroup__IO_html_gaa69be631b50d82c02164fe90977565b0"><div class="ttname"><a href="group__IO.html#gaa69be631b50d82c02164fe90977565b0">TAT::Singular::show</a></div><div class="ttdeci">std::string show() const</div><div class="ttdef"><b>Definition:</b> io.hpp:558</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_aeed42467b017f72ad76cdfea159622d3"><div class="ttname"><a href="structTAT_1_1Singular.html#aeed42467b017f72ad76cdfea159622d3">TAT::Singular::singular_map</a></div><div class="ttdeci">normal_map singular_map</div><div class="ttdef"><b>Definition:</b> tensor.hpp:57</div></div>
<div class="ttc" id="agroup__Miscellaneous_html_ga03fb813e3f2c8c1633ebe103894051a3"><div class="ttname"><a href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">TAT::real_base_t</a></div><div class="ttdeci">typename real_base&lt; T &gt;::type real_base_t</div><div class="ttdef"><b>Definition:</b> basic_type.hpp:97</div></div>
<div class="ttc" id="agroup__IO_html_ga5f350c294d755e5988a4d1d815770bca"><div class="ttname"><a href="group__IO.html#ga5f350c294d755e5988a4d1d815770bca">TAT::Tensor::show</a></div><div class="ttdeci">std::string show() const</div><div class="ttdef"><b>Definition:</b> io.hpp:551</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a7ec63ae19ef65473a16821b49ff0bf3d"><div class="ttname"><a href="structTAT_1_1Tensor.html#a7ec63ae19ef65473a16821b49ff0bf3d">TAT::Tensor::qr</a></div><div class="ttdeci">qr_result qr(char free_name_direction, const SetName &amp;free_name_set, const Name &amp;common_name_q, const Name &amp;common_name_r) const</div><div class="ttdoc">对张量进行qr分解</div><div class="ttdef"><b>Definition:</b> qr.hpp:315</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a1d423525b08fa4b1624435798c2be80d"><div class="ttname"><a href="structTAT_1_1Tensor.html#a1d423525b08fa4b1624435798c2be80d">TAT::Tensor::~Tensor</a></div><div class="ttdeci">~Tensor()=default</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a92fcbf9f6877a19832fa15b38af050e4"><div class="ttname"><a href="structTAT_1_1Singular.html#a92fcbf9f6877a19832fa15b38af050e4">TAT::Singular::load</a></div><div class="ttdeci">Singular&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; load(const std::string &amp;string) &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:90</div></div>
<div class="ttc" id="agroup__IO_html_ga020c0be4a859687755aeef9b910d5c1b"><div class="ttname"><a href="group__IO.html#ga020c0be4a859687755aeef9b910d5c1b">TAT::Singular::dump</a></div><div class="ttdeci">std::string dump() const</div><div class="ttdef"><b>Definition:</b> io.hpp:605</div></div>
<div class="ttc" id="agroup__IO_html_ga324fca0e2b2ab0e6e4524bda982788fd"><div class="ttname"><a href="group__IO.html#ga324fca0e2b2ab0e6e4524bda982788fd">TAT::Tensor::data_get</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; data_get(std::istream &amp;)</div><div class="ttdef"><b>Definition:</b> io.hpp:622</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a913bb31e5ca738fb74f646e5512a4c36"><div class="ttname"><a href="structTAT_1_1Tensor.html#a913bb31e5ca738fb74f646e5512a4c36">TAT::Tensor::summary</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; summary(const int root) const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:731</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab340c1d28f5e68c87fd000ea4f77a2e5"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab340c1d28f5e68c87fd000ea4f77a2e5">TAT::Tensor::merge_edge</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; merge_edge(MapNameVectorName merge, bool apply_parity=false, SetName &amp;&amp;parity_exclude_name_merge={}, SetName &amp;&amp;parity_exclude_name_reverse={}) const</div><div class="ttdoc">合并张量的一些边</div><div class="ttdef"><b>Definition:</b> edge_miscellaneous.hpp:66</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a4804ab139acbaa19d5efb0b033653e71"><div class="ttname"><a href="structTAT_1_1Tensor.html#a4804ab139acbaa19d5efb0b033653e71">TAT::Tensor::Tensor</a></div><div class="ttdeci">Tensor(ScalarType number)</div><div class="ttdoc">创建秩为零的张量</div><div class="ttdef"><b>Definition:</b> tensor.hpp:201</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ad7be591e974161d7c1b5a94082abb937"><div class="ttname"><a href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">TAT::Tensor::Tensor</a></div><div class="ttdeci">Tensor()=default</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_d1f80ff82539b6697abb4a4794b81257.html">TAT</a></li><li class="navelem"><a class="el" href="tensor_8hpp.html">tensor.hpp</a></li>
    <li class="footer">生成于 2021年 一月 22日 星期五 13:53:52 , 为 TAT使用 
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
